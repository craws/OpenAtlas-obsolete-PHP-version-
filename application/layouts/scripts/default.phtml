<?= $this->doctype() ?>
<? $version = Zend_Registry::get('config')->get('version') ?>
<? $user = Zend_Registry::get('user'); ?>
<? $controller = Zend_Controller_Front::getInstance()->getRequest()->getControllerName(); ?>
<? $menu = ['index' => _('home'), 'contact' => _('contact')]; ?>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <?= $this->headTitle() ?>
        <link href="/css/reset.css" rel="stylesheet" />
        <? foreach (['admin_style.css', 'admin_color.css', 'admin_images.css'] as $styleSheet): ?>
            <link rel="stylesheet" href="/css/<?= $styleSheet ?>?v=<?= $version ?>" />
        <? endforeach ?>
    </head>
    <body>
        <div id="adminHead">
            <div id="adminLogo"><a href="/"></a></div>
            <div id="websiteName">
                <? if (strpos(filter_input(INPUT_SERVER, 'HTTP_HOST'), 'local') !== false): ?>
                    <span class="info">local</span>
                <? endif ?>
                <? if (Model_SettingsMapper::getSetting("general", "offline") &&
                    in_array($user->group, ['admin', 'editor'])): ?>
                    <span class="error">Offline</span>
                <? endif ?>
                <? if (Model_SettingsMapper::getSetting("general", "maintenance") && $user->group == 'admin'): ?>
                    <span class="error">Maintenance</span>
                <? endif ?>
                <br/>
                <? foreach ($this->messenger() as $message): ?>
                    <br/>
                    <div class='message <?= $message['type'] ?>'>
                        <?= $this->translate($message['message']) ?>
                    </div>
                <? endforeach ?>
            </div>
            <div id="adminUser">
                <? if ($user->active): ?>
                    <div id="greeting">
                        <?= $this->ucstring('hello') ?> <?= $user->username ?>
                    </div>
                    <div>
                        <a href="/admin/profile"><?= $this->ucstring('profile') ?></a> |
                        <a href="/admin/index/logout"><?= $this->ucstring('logout') ?></a>
                    </div>
                    <div id="changelog">
                        <a href="/admin/overview/changelog"><?= $this->ucstring('version') ?> <?= $version ?></a>
                    </div>
                <? endif ?>
                <div id="languageMenu">
                    <?= $this->languageMenu() ?>
                    <div class="languageSeparator">|</div>
                    <? if ($user->active): ?>
                        <a href="/admin"><?= $this->ucstring('admin') ?></a>
                    <? else: ?>
                        <a href="/admin"><?= $this->ucstring('login') ?></a>
                    <? endif ?>
                </div>
            </div>
        </div>
        <div style="clear:both;"></div>
        <div id="adminMenu">
            <? foreach ($menu as $item => $label): ?>
                <div <?= $item == $controller ? 'class="selected"' : "" ?>>
                    <a href="/<?= $item ?>"><?= $this->ucstring($label) ?></a>
                </div>
            <? endforeach ?>
        </div>
        <div id="content">
            <?= $this->layout()->content ?>
            <? if (strpos(filter_input(INPUT_SERVER, 'HTTP_HOST'), 'craws.net') !== false): ?>
                <div id="poweredBy">
                    Another
                    <a href="http://openatlas.eu" onclick="window.open(this.href); return false;">OpenAtlas</a>
                    project powered by
                    <a href="http://craws.net" onclick="window.open(this.href); return false;"> craws.net</a>
                </div>
            <? endif ?>
        </div>
    </body>
</html>
